import{f}from"./index-9e7089d6.js";const S={apiKey:"AIzaSyB-5AQuNAyFOkiswfOfdsVPQQmK1lGdPrE",authDomain:"live-streaming-caa97.firebaseapp.com",projectId:"live-streaming-caa97",storageBucket:"live-streaming-caa97.appspot.com",messagingSenderId:"584327862946",appId:"1:584327862946:web:07b77f791c6e3d8fe855fb",measurementId:"G-ZZFE0N8W8Y"};f.apps.length||f.initializeApp(S);const m=f.firestore(),g={iceServers:[{urls:["stun:stun1.1.google.com.19302","stun:stun2.1.google.com.19302"]}],iceCandidatePoolSize:10};let e=new RTCPeerConnection(g),r=null,u=null;const y=document.querySelector("#webcamButton"),D=document.querySelector("#liveVideo"),w=document.querySelector("#remoteVideo");console.log(w);const I=document.querySelector("#callButton");y.onclick=async()=>{r=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),r.getTracks().forEach(t=>{e.addTrack(t,r)}),D.srcObject=r};I.onclick=async()=>{const t=m.collection("calls").doc(),o=t.collection("offerCandidates"),l=t.collection("answerCandidates");document.querySelector("#callInput").value=t.id,e.onicecandidate=c=>{c.candidate&&o.add(c.candidate.toJSON())};const n=await e.createOffer();await e.setLocalDescription(n);const i={sdp:n.sdp,type:n.type};await t.set({offer:i}),t.onSnapshot(c=>{const a=c.data();if(!e.currentRemoteDescription&&(a!=null&&a.answer)){const s=new RTCSessionDescription(a.answer);e.setRemoteDescription(s)}}),l.onSnapshot(c=>{c.docChanges().forEach(a=>{if(a.type==="added"){const s=new RTCIceCandidate(a.doc.data());e.addIceCandidate(s)}})})};document.querySelector("#answerButton").onclick=async()=>{const t=document.querySelector("#callInput").value,o=m.collection("calls").doc(t),l=o.collection("offerCandidates"),n=o.collection("answerCandidates");e.onicecandidate=d=>{d.candidate&&n.add(d.cadidate.toJSON())};const i=(await o.get()).data();console.log(i.offer);const c=i.offer;await e.setRemoteDescription(new RTCSessionDescription(c));const a=await e.createAnswer();await e.setLocalDescription(a);const s={type:a.type,sdp:a.sdp};await o.update({answer:s}),l.onSnapshot(d=>{d.docChanges().forEach(p=>{if(console.log(p),p.type==="added"){let C=p.doc.data();e.addIceCandidate(new RTCIceCandidate(C))}})})};u=new MediaStream;e.ontrack=t=>{t.streams[0].getTracks().forEach(o=>{u.addTrack(o)})};w.srcObject=u;
